{% extends "base.html" %}
{% load static %}

{% block main-content %}

{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
        <div class="alert {% if message.tags == 'error' %}alert-danger{% else %}alert-success{% endif %}" role="alert">
            {{ message }}
        </div>
    {% endfor %}
</div>
{% endif %}

<div class="container my-3 p-3">
    <div class="row justify-content-center">
        <!-- Ph·∫ßn Donate (1/3 m√†n h√¨nh) -->
        <div class="col-lg-4">
            <div class="card shadow-lg border-0 rounded-lg">
                <div class="card-header text-center" style="margin-bottom: -10px;">
                    <h3 class="font-weight-light my-1">‚ù§Ô∏è Donate ngay!</h3>
                </div>
                <div class="card-body text-center">
                    <form method="POST" action="{% url 'donate' %}">
                        {% csrf_token %}
                        <p><strong>Ch·ªçn s·ªë ti·ªÅn:</strong></p>
                        <div class="d-flex flex-wrap justify-content-center gap-2 mb-3">
                            <button type="button" class="money-btn btn btn-warning" data-value="10000" onclick="selectAmount(10000)">10,000 VNƒê</button>
                            <button type="button" class="money-btn btn btn-warning" data-value="20000" onclick="selectAmount(20000)">20,000 VNƒê</button>
                            <button type="button" class="money-btn btn btn-warning" data-value="50000" onclick="selectAmount(50000)">50,000 VNƒê</button>
                            <button type="button" class="money-btn btn btn-warning" data-value="100000" onclick="selectAmount(100000)">100,000 VNƒê</button>
                            <button type="button" class="money-btn btn btn-warning" data-value="200000" onclick="selectAmount(200000)">200,000 VNƒê</button>
                            <button type="button" class="money-btn btn btn-warning" data-value="500000" onclick="selectAmount(500000)">500,000 VNƒê</button>
                        </div>
                        <input type="hidden" id="amount" name="amount" required>
                        <div class="form-group">
                            <label for="message">L·ªùi nh·∫Øn:</label>
                            <input type="text" name="message" class="form-control" placeholder="C·∫£m ∆°n b·∫°n!">
                        </div>
                        <button type="submit" class="btn btn-success mt-2" style="transition: background-color 0.3s ease;">üíñ Donate ngay!</button>
                    </form>
                </div>
            </div>

            <!-- L·ªãch s·ª≠ donate c·ªßa user -->
            <div class="card shadow-lg border-0 rounded-lg mt-4">
                <div class="card-header text-center" style="margin-bottom: -10px;">
                    <h4 class="font-weight-light my-1">üìú L·ªãch s·ª≠ donate c·ªßa b·∫°n</h4>
                </div>
                <div class="card-body">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>S·ªë ti·ªÅn</th>
                                <th>L·ªùi nh·∫Øn</th>
                                <th>Th·ªùi gian</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for donation in user_donations %}
                                <tr>
                                    <td>{{ donation.amount }}</td>
                                    <td>{{ donation.message|default:"Kh√¥ng c√≥" }}</td>
                                    <td>{{ donation.created_at }}</td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="3" class="text-center">B·∫°n ch∆∞a donate l·∫ßn n√†o.</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- B·∫£ng donate t·ªïng th·ªÉ (2/3 m√†n h√¨nh) -->
        <div class="col-lg-8">
            <div class="card shadow-lg border-0 rounded-lg mt-4">
                <div class="card-header text-center">
                    <h3 class="font-weight-light my-1">B·∫£ng ƒë√≥ng g√≥p</h3>
                </div>
                <div class="card-body">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Ng∆∞·ªùi ·ªßng h·ªô</th>
                                <th>S·ªë ti·ªÅn</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for donation in donations %}
                                <tr>
                                    <td>{{ donation.customer__name }}</td>
                                    <td>{{ donation.total_amount }}</td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="4" class="text-center">Ch∆∞a c√≥ donation n√†o.</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .btn-success:hover {
        background-color: #218838;
    }
    .money-btn.active {
        background-color: #ffc107;
        color: #000;
        font-weight: bold;
    }
</style>

<script>
    
    function selectAmount(value) {
        document.getElementById('amount').value = value;
        document.querySelectorAll('.money-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector(`[data-value="${value}"]`).classList.add('active');
    }

</script>

{% endblock %}